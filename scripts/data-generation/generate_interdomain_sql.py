import sqlite3
import json

# Interdomain courses that need the attribute
interdomain_courses_raw = """AA 113N,AA 120N,AA 130N,AA 160N,AA 193N,AA 230N,AAS 100N,AED 233N,AED 355Q,AEE 204N,AFAM 100N,AFAM 101N,AFAM 105N,AFAM 110N,AFAM 111N,AFAM 114N,AFAM 126N,AFAM 141N,AFAM 207N,AFAM 226N,AFAM 364N,AFAM 435N,AFR 110N,AFR 202N,AFR 230N,AFR 435N,AG 180N,AGBM 170N,AGECO 134N,AMST 106N,AMST 150N,AMST 151N,AMST 160N,AMST 161N,AMST 170N,AMST 226N,AMST 307N,AMST 308N,AMST 309N,ANSC 332N,ANTH 2N,ANTH 9N,ANTH 40Q,ANTH 45N,ANTH 45Q,ANTH 60N,ANTH 100N,ANTH 129N,ANTH 150N,ANTH 150Q,ANTH 210N,ANTH 216N,ANTH 219N,ANTH 221N,ANTH 240N,ANTH 434N,APLNG 220N,APLNG 230N,APLNG 260,APLNG 280N,APLNG 290N,APLNG 320N,ARCH 170N,ART 51N,ART 116N,ART 160N,ART 170N,ART 175N,ART 207N,ARTH 101N,ARTH 105N,ARTH 107N,ARTH 115N,ARTH 202N,ARTH 222N,ARTH 222Q,ARTH 224N,ARTH 225N,ARTH 292N,ARTH 307N,ARTH 308N,ASIA 101N,ASIA 106N,ASIA 107N,ASTRO 7N,ASTRO 19N,ASTRO 141N,AYFCE 211N,BBH 150N,BBH 201N,BIOET 110N,BIOET 220N,BIOET 401Q,BIOL 160N,BIOL 169N,CAMS 12N,CAS 101N,CAS 162N,CAS 170N,CAS 175N,CAS 182N,CAS 208N,CAS 222N,CAS 232N,CAS 240N,CAS 271N,CAS 272N,CAS 297N,CAS 383N,CED 102N,CED 102Q,CED 109N,CED 400N,CHEM 233N,CHNS 121N,CI 105N,CI 304N,CI 340N,CIVCM 211N,CMAS 258N,CMLIT 19N,CMLIT 112N,CMLIT 128N,CMLIT 133N,CMLIT 147N,CMLIT 183Q,CMLIT 191N,CMLIT 240Q,CMPSC 150N,COMM 20N,COMM 100N,COMM 101N,COMM 150N,COMM 150Q,COMM 151N,COMM 175N,COMM 208N,COMM 222N,COMM 234N,COMM 290N,COMM 297N,COMM 335N,CRIM 225N,CRIMJ 150N,CRIMJ 205N,DART 102N,DIGIT 220N,EARTH 103N,EARTH 104N,EARTH 105N,EARTH 107N,EARTH 111N,EARTH 155N,EARTH 200N,ECON 472N,EDUC 205N,EDUC 466N,EGEE 110N,EMSC 240N,ENGL 108N,ENGL 115N,ENGL 128N,ENGL 141N,ENGL 142N,ENGL 161N,ENGL 162N,ENGL 163N,ENGL 165N,ENGL 170N,ENGL 183N,ENGL 190Q,ENGL 193N,ENGL 208N,ENGL 223N,ENGL 224N,ENGL 225N,ENGL 233N,ENGL 236N,ENGL 237N,ENGR 115N,ENGR 120N,ENGR 467Q,ENT 202N,ENT 216N,ENT 222N,ENVST 100N,ESC 220N,FOR 123N,FOR 201N,FR 138N,GAME 160N,GAME 180N,GD 115N,GEOG 1N,GEOG 2N,GEOG 3N,GEOG 6N,GEOG 30N,GEOG 107N,GEOG 330N,GEOG 332N,GEOSC 107N,GEOSC 212N,GER 115N,GER 128N,GER 157N,GER 189N,GER 197E,GER 200N,GLIS 101N,GLIS 102N,HDFS 101N,HDFS 108N,HDFS 175N,HDFS 197N,HDFS 215N,HDFS 245N,HDFS 249N,HDFS 254N,HDFS 258N,HHD 197N,HHD 200N,HHD 497I,HHUM 110N,HHUM 111N,HHUM 220N,HIST 6N,HIST 114N,HIST 116N,HIST 120N,HIST 125N,HIST 128N,HIST 129N,HIST 131N,HIST 142N,HIST 143N,HIST 145N,HIST 151N,HIST 162N,HIST 203N,HIST 212N,HIST 238N,HIST 240Q,HIST 255N,HIST 292N,HIST 297N,HIST 402N,HM 210N,HORT 150N,HORT 169N,HUM 100N,HUM 150N,HUM 197N,HUM 200N,HUM 220N,HUM 300N,HUM 400N,INART 55N,INART 126N,INART 141N,INART 203Q,INART 226N,INTAG 100N,IST 144N,IST 170N,IST 234N,IT 210N,IT 225N,IT 240Q,JAPNS 121N,JST 12N,JST 60N,JST 128N,JST 143N,JST 320N,KINES 53N,KINES 54N,KINES 85N,KINES 160N,KINES 197N,KINES 222N,KINES 405N,KOR 121N,LA 135N,LA 335N,LARCH 247N,LARCH 405N,LDT 110N,LHR 160N,LHR 165N,LLED 215N,LTNST 315N,MATH 197N,MATSE 297N,METEO 1N,METEO 6N,METEO 51N,METEO 133N,METEO 332N,MUSIC 207N,MUSIC 209N,NURS 325N,NUTR 175N,NUTR 291N,NUTR 310N,PHIL 60N,PHIL 120N,PHIL 131N,PHIL 133N,PHIL 136N,PHIL 137N,PHIL 150N,PHIL 242N,PHOTO 321N,PLANT 129N,PLSC 7N,PLSC 17N,PLSC 17W,PLSC 60N,PLSC 112N,PLSC 120N,PLSC 177N,PLSC 183N,PLSC 200N,PLSC 201N,PLSC 210N,PLSC 222N,PLSC 223N,PLSC 267N,PLSC 290N,PORT 210N,PPEM 170N,PSYCH 109N,PSYCH 120N,PSYCH 150N,PSYCH 150Q,PSYCH 169N,PSYCH 175N,PSYCH 217N,PSYCH 246N,PSYCH 263N,PUBPL 120N,PUBPL 222N,RLST 12N,RLST 105N,RLST 133N,RSOC 400N,RUS 101N,SC 60N,SC 103N,SC 120N,SC 125N,SC 135N,SC 142N,SC 145N,SC 150N,SC 183Q,SC 205N,SC 475N,SOC 20N,SOC 60N,SOC 119N,SOC 120N,SOC 130N,SOC 145N,SOC 150N,SOC 162N,SOC 180N,SOC 205N,SOC 208N,SOC 210N,SOC 245N,SOC 258N,SOC 290N,SPAN 210N,SPAN 215Q,SPAN 269N,SPAN 297N,SPAN 315N,SSED 100N,STS 110N,STS 151N,STS 245N,SUST 150N,SUST 242N,SUST 325N,THEA 101N,VBSC 280N,VBSC 340N,WFS 209N,WMNST 83N,WMNST 101N,WMNST 105N,WMNST 106N,WMNST 106Q,WMNST 116N,WMNST 175N,WMNST 202N,WMNST 207N,WMNST 225N,WMNST 230N,WMNST 240Q,WMNST 301N,WMNST 364N,WMNST 400N"""

courses = [c.strip() for c in interdomain_courses_raw.split(',')]

db = sqlite3.connect('/Users/V-Personal/V/lib/data/courses.db')
cursor = db.cursor()

print("-- SQL script to add interdomain attribute to Inter-Domain courses")
print("-- Generated automatically - preserves existing attributes")
print()

count = 0
for course in courses:
    cursor.execute("SELECT gen_ed_json FROM courses WHERE id = ?", (course,))
    row = cursor.fetchone()
    if row:
        current = json.loads(row[0]) if row[0] else []
        if 'interdomain' not in current:
            new_attrs = current + ['interdomain']
            new_json = json.dumps(new_attrs)
            course_escaped = course.replace("'", "''")
            print(f"UPDATE courses SET gen_ed_json = '{new_json}' WHERE id = '{course_escaped}';")
            count += 1

print(f"\n-- Total updates: {count}")
db.close()
